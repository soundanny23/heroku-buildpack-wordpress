<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Wordpress on Heroku by soundanny23</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Wordpress on Heroku</h1>
      <h2 class="project-tagline">Deploy Wordpress to Heroku in &lt; 60 seconds or your money back</h2>
      <a href="https://github.com/soundanny23/heroku-buildpack-wordpress" class="btn">View on GitHub</a>
      <a href="https://github.com/soundanny23/heroku-buildpack-wordpress/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/soundanny23/heroku-buildpack-wordpress/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <p><img src="https://fbcdn-profile-a.akamaihd.net/hprofile-ak-xta1/v/t1.0-1/p160x160/11143468_910317815701235_8264770685388973747_n.jpg?oh=bba7941f71f11a3e3cfe4836ad9be801&amp;oe=5680497B&amp;__gda__=1447662165_78ce5685b3dca9c78e53d1a6bfbeaf95" alt=""># Heroku buildpack: Wordpress on Heroku</p>

<h3>
<a id="this-is-a-heroku-buildpack-for-running-wordpress-on-heroku" class="anchor" href="#this-is-a-heroku-buildpack-for-running-wordpress-on-heroku" aria-hidden="true"><span class="octicon octicon-link"></span></a>This is a Heroku buildpack for running <a href="http://wordpress.org">Wordpress</a> on <a href="http://heroku.com">Heroku</a>
</h3>

<p>It uses this <a href="http://github.com/mchung/wordpress-on-heroku">Wordpress</a> project template to bootstrap a highly tuned Wordpress site built on the following stack:</p>

<ul>
<li>
<code>nginx</code> - Nginx for serving web content.  Built specifically for Heroku.  <a href="https://github.com/mchung/heroku-buildpack-wordpress/blob/master/support/package_nginx">See compile options</a>.</li>
<li>
<code>php</code> - PHP-FPM for process management.  <a href="https://github.com/mchung/heroku-buildpack-wordpress/blob/master/support/package_php">See compile options</a>.</li>
<li>
<code>wordpress</code> - Downloaded directly <a href="http://wordpress.org/download/release-archive/">from wordpress.org</a>.</li>
<li>
<code>MySQL</code> - ClearDB for the MySQL backend.</li>
<li>
<code>Sendgrid</code> - Sendgrid for the email backend.</li>
<li>
<code>MemCachier</code> - MemCachier for the memcached backend.</li>
</ul>

<p>You can see a live demo at <a href="http://wordpress-on-heroku.herokuapp.com">Wordpress on Heroku</a>.</p>

<h2>
<a id="getting-started-in-60-seconds" class="anchor" href="#getting-started-in-60-seconds" aria-hidden="true"><span class="octicon octicon-link"></span></a>Getting started in 60 seconds</h2>

<p>Fork and rename the <a href="http://github.com/mchung/wordpress-on-heroku">Wordpress project template</a>.</p>

<p>Let's clone the repository for a new blog, 99catfacts.com</p>

<div class="highlight highlight-bash"><pre>$ git clone git://github.com/your_name/wordpress-on-heroku.git 99catfacts.com</pre></div>

<p>Create Wordpress on Heroku.</p>

<div class="highlight highlight-bash"><pre>$ <span class="pl-c1">cd</span> 99catfacts.com
$ heroku create -s cedar
$ heroku config:add BUILDPACK_URL=https://github.com/mchung/heroku-buildpack-wordpress.git</pre></div>

<blockquote>
<p>Don't have the Heroku Toolbelt installed? Follow these <a href="https://devcenter.heroku.com/articles/quickstart">quickstart instructions</a>. Takes about 2 minutes.</p>
</blockquote>

<p>Deploy your Wordpress site to Heroku.</p>

<div class="highlight highlight-bash"><pre>$ git push heroku master
...
-----<span class="pl-k">&gt;</span> Heroku receiving push
-----<span class="pl-k">&gt;</span> Fetching custom git buildpack... <span class="pl-k">done</span>
-----<span class="pl-k">&gt;</span> Wordpress app detected
<span class="pl-c1">.</span>
[...]
<span class="pl-c1">.</span>
-----<span class="pl-k">&gt;</span> Discovering process types
       Procfile declares types     -<span class="pl-k">&gt;</span> (none)
       Default types <span class="pl-k">for</span> <span class="pl-smi">Wordpress</span> -<span class="pl-k">&gt;</span> web
-----<span class="pl-k">&gt;</span> Compiled slug size: 33.7MB
-----<span class="pl-k">&gt;</span> Launching... <span class="pl-k">done</span>, v7</pre></div>

<p>Open your new Wordpress site in a web browser.</p>

<div class="highlight highlight-bash"><pre>$ heroku apps:open</pre></div>

<blockquote>
<p>Happy? Add your site to the growing <a href="https://github.com/mchung/heroku-buildpack-wordpress/wiki/Sites-running-Wordpress-on-Heroku">list of Wordpress sites runnning on Heroku</a>.</p>
</blockquote>

<h2>
<a id="overview" class="anchor" href="#overview" aria-hidden="true"><span class="octicon octicon-link"></span></a>Overview</h2>

<p>The buildpack bootstraps a Wordpress site using the <a href="http://github.com/mchung/wordpress-on-heroku">mchung/wordpress-on-heroku</a> project template.  That repo contains everything required to run your own Wordpress site on Heroku.</p>

<p>There are several files available in <code>config</code> for configuring your new Wordpress site.</p>

<pre><code>└── config                # Your config files goes here.
    ├── public            # The public directory
    │   └── wp-content    # Wordpress themes and plugins
    │       ├── plugins
    │       └── themes
    └── vendor            # Config files for vendored apps
        ├── nginx
        │   └── conf      # nginx.conf + your site.conf
        └── php
            └── etc       # php.ini &amp; php-fpm.conf
</code></pre>

<p>When you deploy Wordpress to Heroku, everything in <code>config</code> is copied over to Heroku.  You can configure your blog by making changes to these files.</p>

<p>A few Wordpress environment variables can be controlled via Heroku using <code>heroku config:set</code>:</p>

<ul>
<li><code>FORCE_SSL_LOGIN</code></li>
<li><code>FORCE_SSL_ADMIN</code></li>
<li><code>WP_CACHE</code></li>
<li><code>DISABLE_WP_CRON</code></li>
</ul>

<blockquote>
<p>To add a Heroku environment variable: <code>heroku config:set GOOG_UA_ID=UA=1234777-9</code></p>
</blockquote>

<p>See <code>wp-config.php</code> and documentation from Wordpress for details.</p>

<p>Enabling and configuring the following Wordpress plugins will also speed up Wordpress on Heroku significantly.</p>

<ul>
<li>
<code>heroku-sendgrid</code> - Configures phpmailer to send SMTP email with Sendgrid.</li>
<li>
<code>heroku-google-analytics</code> - Configures Google Analytics to display on your Wordpress site.

<ul>
<li>GOOG_UA_ID=UA-9999999</li>
</ul>
</li>
<li>
<code>wpro</code> - Configures Wordpress to upload everything to S3.</li>
<li>
<code>batcache</code> - Configures Wordpress to use memcached for caching.</li>
<li>
<code>memcachier</code> - Use a modern memcached plugin.</li>
<li>
<code>cloudflare</code> - OPTIONAL, but very awesome.

<ul>
<li>If Cloudflare is installed, the plugin configures Wordpress to play nicely with CloudFlare.  It sets the correct IP addresses from visitors and comments, and also protects Wordpress from spammers.</li>
<li>Keep in mind that the free version doesn't support SSL, so you'll need to set both <code>FORCE_SSL_ADMIN</code> and <code>FORCE_SSL_LOGIN</code> to false in order to login.</li>
</ul>
</li>
</ul>

<h2>
<a id="usage" class="anchor" href="#usage" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage</h2>

<h3>
<a id="creating-your-wordpress-site-on-heroku" class="anchor" href="#creating-your-wordpress-site-on-heroku" aria-hidden="true"><span class="octicon octicon-link"></span></a>Creating your Wordpress site on Heroku</h3>

<div class="highlight highlight-bash"><pre>$ git clone git://github.com/username/wordpress-on-heroku.git myblog
$ <span class="pl-c1">cd</span> myblog
$ heroku create -s cedar
$ heroku config:add BUILDPACK_URL=https://github.com/mchung/heroku-buildpack-wordpress.git
$ git push heroku master</pre></div>

<h3>
<a id="adding-a-custom-domain-name" class="anchor" href="#adding-a-custom-domain-name" aria-hidden="true"><span class="octicon octicon-link"></span></a>Adding a custom domain name</h3>

<div class="highlight highlight-bash"><pre>$ heroku domains:add marcchung.org
$ heroku domains:add www.marcchung.org</pre></div>

<p>Note: Adding a domain still requires some DNS setup work. Basically you'll want to do something like this:</p>

<div class="highlight highlight-bash"><pre>ALIAS marcchung.org -<span class="pl-k">&gt;</span> proxy.herokuapp.com
CNAME www.marcchung.org -<span class="pl-k">&gt;</span> proxy.herokuapp.com</pre></div>

<blockquote>
<p><a href="https://dnsimple.com/r/d2bc9a934910c1">I use DNSimple and you should too</a>.</p>
</blockquote>

<h3>
<a id="adding-a-theme" class="anchor" href="#adding-a-theme" aria-hidden="true"><span class="octicon octicon-link"></span></a>Adding a theme</h3>

<div class="highlight highlight-bash"><pre>$ cp -r appply config/public/wp-content/themes/
$ git add <span class="pl-c1">.</span>
$ git commit -m <span class="pl-s"><span class="pl-pds">"</span>New theme<span class="pl-pds">"</span></span>
$ git push heroku master</pre></div>

<h3>
<a id="adding-a-plugin" class="anchor" href="#adding-a-plugin" aria-hidden="true"><span class="octicon octicon-link"></span></a>Adding a plugin</h3>

<div class="highlight highlight-bash"><pre>$ cp -r google-analytics config/public/wp-content/plugins/
$ git add <span class="pl-c1">.</span>
$ git commit -m <span class="pl-s"><span class="pl-pds">"</span>New plugin<span class="pl-pds">"</span></span>
$ git push heroku master</pre></div>

<blockquote>
<p>Plugins and themes must be activated via the Plugins panel.</p>
</blockquote>

<h3>
<a id="adding-custom-secret-keys-to-wp-configphp" class="anchor" href="#adding-custom-secret-keys-to-wp-configphp" aria-hidden="true"><span class="octicon octicon-link"></span></a>Adding custom secret keys to wp-config.php</h3>

<p>Use the <a href="https://api.wordpress.org/secret-key/1.1/salt/">Wordpress.org secret-key service</a> to override the default ones in <code>wp-config.php</code>.</p>

<h3>
<a id="configuring-cron" class="anchor" href="#configuring-cron" aria-hidden="true"><span class="octicon octicon-link"></span></a>Configuring cron</h3>

<p>By default, wp-cron is fired on every page load and scheduled to run jobs like future posts or backups.  This buildpack disables wp-cron so that visitors don't have to wait to see the site.</p>

<p>Heroku allows you to trigger wp-cron from their scheduler.</p>

<div class="highlight highlight-bash"><pre>$ heroku addons:add scheduler:standard

<span class="pl-c"># Visit the Heroku scheduler dashboard and add a new task:</span>
./cron.sh</pre></div>

<p>Alternatively, you may also re-enable wp-cron.</p>

<div class="highlight highlight-bash"><pre>$ heroku config:<span class="pl-c1">set</span> DISABLE_WP_CRON=<span class="pl-c1">false</span></pre></div>

<h3>
<a id="enable-system-access" class="anchor" href="#enable-system-access" aria-hidden="true"><span class="octicon octicon-link"></span></a>Enable system access</h3>

<p>The alternative PHP cache and a generic PHPINFO page is available at /apc.php and /phpinfo.php.</p>

<div class="highlight highlight-bash"><pre>$ heroku config:<span class="pl-c1">set</span> ENABLE_SYSTEM_DEBUG=<span class="pl-c1">true</span>
$ heroku config:<span class="pl-c1">set</span> SYSTEM_USERNAME=admin
$ heroku config:<span class="pl-c1">set</span> SYSTEM_PASSWORD=secret123
<span class="pl-c"># Visit /apc.php or /phpinfo.php</span></pre></div>

<h3>
<a id="remove-the-php-fpm-status-page-statushtml" class="anchor" href="#remove-the-php-fpm-status-page-statushtml" aria-hidden="true"><span class="octicon octicon-link"></span></a>Remove the PHP-FPM status page <code>/status.html</code>
</h3>

<p>Delete the directive from <code>nginx.conf.erb</code>.</p>

<h3>
<a id="add-a-faviconico-drop-one-into-public" class="anchor" href="#add-a-faviconico-drop-one-into-public" aria-hidden="true"><span class="octicon octicon-link"></span></a>Add a <code>favicon.ico</code> drop one into <code>public</code>
</h3>

<p>See <a href="https://github.com/mchung/heroku-buildpack-wordpress/issues/22">#22</a> for details.</p>

<h3>
<a id="choosing-specific-versions-of-vendored-packages" class="anchor" href="#choosing-specific-versions-of-vendored-packages" aria-hidden="true"><span class="octicon octicon-link"></span></a>Choosing specific versions of vendored packages</h3>

<p>See <a href="VERSIONS.md">VERSIONS</a> for how to pick specific versions of Nginx, PHP, and Wordpress</p>

<h3>
<a id="workflow-optional" class="anchor" href="#workflow-optional" aria-hidden="true"><span class="octicon octicon-link"></span></a>Workflow (optional)</h3>

<p>By keeping your changes separate, it'll be easier to pull in changes from the Wordpress site template.</p>

<p>Assign a remote <code>upstream</code></p>

<div class="highlight highlight-bash"><pre>$ git remote add upstream https://github.com/your_name/wordpress-on-heroku.git</pre></div>

<p>Track changes in a separate branch called <code>production</code>.</p>

<div class="highlight highlight-bash"><pre>$ git checkout -B production
$ git push heroku production:master
<span class="pl-c"># This keeps upstream (my) changes separate from (your) blog changes.</span></pre></div>

<p>Pull changes from upstream into <code>master</code>.</p>

<div class="highlight highlight-bash"><pre>$ git co master
$ git pull
$ git co production
$ git merge master</pre></div>

<p>Pull changes from upstream into <code>production</code>.</p>

<div class="highlight highlight-bash"><pre>$ git pull --rebase upstream master</pre></div>

<h2>
<a id="how-fast-is-this" class="anchor" href="#how-fast-is-this" aria-hidden="true"><span class="octicon octicon-link"></span></a>How fast is this?</h2>

<p>Pretty freaking fast.</p>

<p>System setup</p>

<ul>
<li>Single Heroku dyno</li>
<li>Default Wordpress installation</li>
<li>Default twentytwelve theme</li>
<li>Caching turned up</li>
<li>Cron disabled</li>
<li>Memcachier + ClearDB</li>
</ul>

<p>Here are some benchmarks from Google PageSpeed, Blitz.io, and Web Page Test.</p>

<h3>
<a id="google-pagespeed" class="anchor" href="#google-pagespeed" aria-hidden="true"><span class="octicon octicon-link"></span></a>Google PageSpeed</h3>

<p>Results from PageSpeed Insights: 94/100</p>

<p><a href="https://developers.google.com/speed/pagespeed/insights#url=wordpress-on-heroku.herokuapp.com&amp;mobile=false">See the PageSpeed report</a></p>

<h3>
<a id="blitzio" class="anchor" href="#blitzio" aria-hidden="true"><span class="octicon octicon-link"></span></a>blitz.io</h3>

<p>Results from a blitz.io rush</p>

<p><img src="https://s3.amazonaws.com/heroku-buildpack-wordpress/woh-blitz-details.png" alt="Blitz.io rush"></p>

<p>Over 200 page views per second with less than 100ms response time sustained for a minute.</p>

<p><a href="https://www.blitz.io/report/541eb908b4ef3eec8d9c2ce2293a85ca">See the Blitz.io report</a></p>

<h3>
<a id="web-page-performance-test" class="anchor" href="#web-page-performance-test" aria-hidden="true"><span class="octicon octicon-link"></span></a>Web Page Performance Test</h3>

<p><img src="https://s3.amazonaws.com/heroku-buildpack-wordpress/woh-webpagetest-details.png" alt="Results from WebPageTest"></p>

<p><a href="http://www.webpagetest.org/result/130201_BB_624/">See the WebPageTest report</a></p>

<p>These tests are periodically rerun on <a href="http://wordpress-on-heroku.herokuapp.com">Wordpress on Heroku</a>.</p>

<h2>
<a id="but-doesnt-heroku-only-run-ruby-applications" class="anchor" href="#but-doesnt-heroku-only-run-ruby-applications" aria-hidden="true"><span class="octicon octicon-link"></span></a>But doesn't Heroku only run Ruby applications?</h2>

<p>Not anymore. Heroku's latest offerings (See <a href="http://devcenter.heroku.com/articles/cedar">Celadon Cedar stack</a>) makes it easy (well, easyish) for developers to install and run any language, or service.</p>

<h2>
<a id="constraints-with-heroku" class="anchor" href="#constraints-with-heroku" aria-hidden="true"><span class="octicon octicon-link"></span></a>Constraints with Heroku</h2>

<p>The <a href="http://devcenter.heroku.com/articles/dyno-isolation">ephemeral filesystem</a></p>

<ul>
<li>End-users cannot upload media assets to Heroku. WORKAROUND: Enable <code>wpro</code> and use that plugin to upload media assets to S3 instead.</li>
<li>End-users cannot update themes or plugins from the admin page. WORKAROUND: Add them to <code>config/public/wp-content/themes</code> or <code>config/public/wp-content/plugins</code> then push to Heroku.</li>
</ul>

<h2>
<a id="security-disclosure" class="anchor" href="#security-disclosure" aria-hidden="true"><span class="octicon octicon-link"></span></a>Security disclosure</h2>

<p>Each time Wordpress is deployed, Heroku will fetch the latest buildpack from GitHub and execute the instructions in <code>compile</code> and <code>deploy</code>.  This buildpack will download the latest precompiled versions of Nginx, PHP, and Wordpress from my personal <a href="http://heroku-buildpack-wordpress.s3.amazonaws.com">S3 bucket</a> then add in config files from the <a href="https://github.com/mchung/wordpress-on-heroku/tree/master/config"><code>config</code></a> directory.</p>

<h2>
<a id="hacking-and-contributing" class="anchor" href="#hacking-and-contributing" aria-hidden="true"><span class="octicon octicon-link"></span></a>Hacking and Contributing</h2>

<p>Not comfortable downloading and running a copy of someone else's PHP or Nginx executables? Not a problem!  The <code>support</code> directory also contains a handful of compilation and deployment scripts to automate several processes, which are currently used for maintenance and repo management.</p>

<ul>
<li>
<code>package_nginx</code> - Used to compile and upload the latest version of Nginx to S3.</li>
<li>
<code>package_php</code> - Used to compile and upload the latest version of PHP to S3.</li>
<li>
<code>wordup</code> - Really useful helper script for creating and destroying Wordpress sites.</li>
</ul>

<h2>
<a id="todo" class="anchor" href="#todo" aria-hidden="true"><span class="octicon octicon-link"></span></a>TODO</h2>

<ul>
<li>End-users shouldn't be able to do things that aren't supported on Heroku. Write plugins to hide everything.</li>
<li>Integrate New Relic.</li>
<li>CDN support.</li>
<li>Combine CSS/JS files</li>
</ul>

<h2>
<a id="authors-and-contributors" class="anchor" href="#authors-and-contributors" aria-hidden="true"><span class="octicon octicon-link"></span></a>Authors and Contributors</h2>

<ul>
<li>Marc Chung - Follow <a href="https://github.com/mchung">@mchung</a> on GitHub and also <a href="https://twitter.com/heisenthought">@heisenthought</a> on Twitter</li>
</ul>

<h2>
<a id="thanks" class="anchor" href="#thanks" aria-hidden="true"><span class="octicon octicon-link"></span></a>Thanks</h2>

<p>Thanks for reading this all the way through.</p>

<p>If you use this buildpack in production, please update the <a href="https://github.com/mchung/heroku-buildpack-wordpress/wiki/Sites-running-Wordpress-on-Heroku">list of Wordpress sites running on Heroku</a>.</p>

<h2>
<a id="license" class="anchor" href="#license" aria-hidden="true"><span class="octicon octicon-link"></span></a>License</h2>

<p>The MIT License - Copyright (c) 2013 Marc Chung</p>

<p></p>

<div id="haiku-1922">
<div>
<div>
take my code with you
</div>

<div>
and do whatever you want
</div>

<div>
but please don't blame me
</div>

<div>
—
Aaron Swartz
</div>

<p></p>
</div>

<div>
<a href="http://haikuist.com/haiku/1922">This Haiku</a>
brought to you by
<a href="http://haikuist.com/">Haikuist</a>
</div>

<p></p>
</div>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/soundanny23/heroku-buildpack-wordpress">Wordpress on Heroku</a> is maintained by <a href="https://github.com/soundanny23">soundanny23</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

            <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-31205985-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>
